<!DOCTYPE html>
<html lang="ru">
<head>
     <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Калькулятор доставки и стоимости теплиц</title>
    <!-- Яндекс.Карты -->
    <script src="https://api-maps.yandex.ru/2.1/?apikey=410a6099-56c9-4669-81c8-f21896edfab0&lang=ru_RU" type="text/javascript"></script>
    <!-- Supabase JavaScript SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.28.0/dist/umd/supabase.min.js"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Авторизация -->
    <div class="auth-container" id="auth-container">
        <h2>Вход в систему</h2>
        <input type="text" id="login" placeholder="Введите логин" required>
        <input type="password" id="password" placeholder="Введите пароль" required>
        <button onclick="authenticate()">Войти</button>
        <p id="auth-error">Неверный логин или пароль!</p>
    </div>

    <!-- Калькулятор -->
    <div class="calculator-container hidden" id="calculator-container">
        <div class="container">
            <button class="logout" onclick="logout()">Выйти</button>
            
            <!-- Блок доставки -->
            <div class="block">
                <h2>Доставка</h2>
                <label for="address">Введите адрес доставки:</label>
                <div class="address-container">
                    <input type="text" id="address" placeholder="Например, Санкт-Петербург, Невский пр." required autocomplete="off">
                    <div id="suggestions"></div>
                </div>
                
                <div class="delivery-options">
                    <label><input type="radio" name="deliveryType" value="withoutAssembly" checked> Без сборки</label>
                    <label><input type="radio" name="deliveryType" value="withAssembly"> Со сборкой</label>
                </div>

                <button id="calculate-delivery" onclick="calculateDelivery()">Рассчитать доставку</button>
                <!-- Добавленная кнопка сброса адреса -->
                <button class="reset-delivery-button" onclick="resetDelivery()">Сбросить доставку</button>
                <div id="result"></div>
                <div id="map"></div>
            </div>

            <!-- Блок теплицы -->
            <div class="block">
                <h2>Стоимость теплицы</h2>

                <div class="parameters">
                    <label for="city">Город:</label>
                    <select id="city" onchange="onCityChange()">
                        <!-- placeholder, не будет выбрано для расчёта -->
                        <option value="" disabled selected>Выберите город</option>
                        <!-- Остальное (список городов) добавит ваш JavaScript -->
                    </select>
                </div>

                <div class="parameters">
                    <label for="form">Форма теплицы:</label>
                    <select id="form" onchange="onFormChange()">
                        <!-- placeholder -->
                        <option value="" disabled selected>Сначала выберите город</option>
                    </select>
                </div>

                <div class="parameters">
                    <label for="width">Ширина (м):</label>
                    <select id="width" onchange="onWidthChange()">
                        <option value="" disabled selected>Выберите ширину</option>
                    </select>
                </div>

                <div class="parameters">
                    <label for="length">Длина (м):</label>
                    <select id="length" onchange="onLengthChange()">
                        <option value="" disabled selected>Выберите длину</option>
                    </select>
                </div>

                <div class="parameters">
                    <label for="frame">Каркас:</label>
                    <select id="frame" onchange="onFrameChange()">
                        <option value="" disabled selected>Выберите каркас</option>
                    </select>
                </div>

                <div class="parameters">
                    <label for="polycarbonate">Поликарбонат:</label>
                    <select id="polycarbonate" onchange="calculateGreenhouseCost()">
                        <!-- Опции будут добавлены через JavaScript в фиксированном порядке -->
                    </select>
                </div>

                <div class="parameters">
                    <label for="arcStep">Шаг между дугами:</label>
                    <select id="arcStep" onchange="calculateGreenhouseCost()">
                        <option value="1" selected>1 м</option>
                        <option value="0.65">0.65 м</option>
                    </select>
                </div>

                <!-- Дополнительные услуги и товары -->
                <div class="additional-services">
                    <div class="checkbox-group-large">
                        <label><input type="checkbox" id="bracing" onchange="calculateGreenhouseCost()"> Брус</label>
                        <label><input type="checkbox" id="assembly" onchange="calculateGreenhouseCost()"> Сборка</label>
                        <label><input type="checkbox" id="ground-hooks" onchange="calculateGreenhouseCost()"> Штыри</label>
                    </div>
                    <p><strong>Монтаж на фундамент клиента</strong></p>
                    <div class="checkbox-group-large">
                        <label><input type="checkbox" id="on-wood" data-price="1500" onchange="calculateGreenhouseCost()"> На брус +1.500 рублей</label>
                        <label><input type="checkbox" id="on-concrete" data-price="2000" onchange="calculateGreenhouseCost()"> На бетон +2.000 рублей</label>
                    </div>
                    <!-- Перемещённая кнопка рассчитать стоимость теплицы -->
                    <button id="calculate-greenhouse" onclick="calculateGreenhouseCost()">Рассчитать стоимость теплицы</button>
                    <!-- Кнопка сброса должна быть под блоком монтажа на фундамент -->
                    <button class="reset-button" onclick="resetAllFilters()">Сбросить все фильтры</button>
                </div>

                <div class="additional-products">
                    <h3>Дополнительные товары:</h3>
                    
                    <div class="product-item">
                        <label class="product-label">
                            <input type="checkbox" id="drip-irrigation-mech" data-price="1690" onchange="calculateGreenhouseCost()">
                            <span class="product-name">Капельный полив механический</span>
                            <span class="price">1.690 рублей</span>
                        </label>
                    </div>
                    
                    <div class="product-item">
                        <label class="product-label">
                            <input type="checkbox" id="drip-irrigation-auto" data-price="4490" onchange="calculateGreenhouseCost()">
                            <span class="product-name">Капельный полив автоматический</span>
                            <span class="price">4.490 рублей</span>
                        </label>
                    </div>
                    
                    <div class="product-item">
                        <label class="product-label">
                            <input type="checkbox" id="window-automation" data-price="2590" onchange="calculateGreenhouseCost()">
                            <span class="product-name">Автомат для форточки</span>
                            <span class="price">2.590 рублей</span>
                        </label>
                    </div>
                    
                    <div class="product-item">
                        <label class="product-label">
                            <input type="checkbox" id="galvanized-tape-30m" data-price="1990" onchange="calculateGreenhouseCost()">
                            <span class="product-name">Оцинкованная лента 30 м</span>
                            <span class="price">1.990 рублей</span>
                        </label>
                    </div>
                    
                    <div class="product-item">
                        <label class="product-label">
                            <input type="checkbox" id="vapor-permeable-tape-25m" data-price="1590" onchange="calculateGreenhouseCost()">
                            <span class="product-name">Паропропускная лента 25 м</span>
                            <span class="price">1.590 рублей</span>
                        </label>
                    </div>
                    
                    <div class="product-item">
                        <label class="product-label">
                            <input type="checkbox" id="additional-window" data-price="1490" onchange="calculateGreenhouseCost()">
                            <span class="product-name">Дополнительная форточка</span>
                            <span class="price">1.490 рублей</span>
                        </label>
                    </div>
                    
                    <div class="product-item">
                        <label class="product-label">
                            <input type="checkbox" id="additional-partition" data-price="5490" onchange="calculateGreenhouseCost()">
                            <span class="product-name">Дополнительная перегородка</span>
                            <span class="price">5.490 рублей</span>
                        </label>
                    </div>
                    
                    <div class="product-item">
                        <label class="product-label">
                            <input type="checkbox" id="additional-partition-door" data-price="6990" onchange="calculateGreenhouseCost()">
                            <span class="product-name">Дополнительная перегородка с дверью</span>
                            <span class="price">6.990 рублей</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Блок коммерческого предложения -->
            <div class="block">
                <h2>Коммерческое предложение</h2>
                <textarea id="commercial-offer" rows="20" readonly>
Здесь будет ваше коммерческое предложение.
                </textarea>
                <button id="copy-cp" onclick="copyCommercialOffer()">Скопировать КП</button>
            </div>
        </div>
        <script src="js/scripts.js"></script>
    </div>
</body>
</html>
